from __future__ import annotations

LANG_ZH = "zh"
LANG_EN = "en"

TRANSLATIONS: dict[str, dict[str, str]] = {
    LANG_ZH: {
        "tab.home": "主页",
        "tab.properties": "属性",
        "tab.constraints_loads": "约束与载荷",
        "tab.background": "背景",
        "tab.solve_results": "求解与结果",
        "tab.help": "帮助",
        "group.file": "文件",
        "group.model": "建模",
        "group.libraries": "库",
        "group.assign": "分配",
        "group.constraints": "约束",
        "group.loads": "载荷",
        "group.background": "背景",
        "group.solve": "求解",
        "group.results": "结果",
        "group.support": "支持",
        "action.new": "新建",
        "action.open": "打开",
        "action.save": "保存",
        "action.select": "选择",
        "action.add_point": "添加点",
        "action.delete": "删除",
        "action.materials": "材料…",
        "action.sections": "截面…",
        "action.assign_property": "分配属性",
        "action.constraint": "约束",
        "action.bush": "弹簧",
        "action.load": "载荷",
        "action.udl": "分布载荷",
        "action.import": "导入",
        "action.calibrate": "标定",
        "action.opacity": "透明度",
        "action.bw": "黑白",
        "action.show_bg": "显示背景",
        "action.hide_bg": "隐藏背景",
        "action.clear": "清除",
        "action.validate": "校验",
        "action.solve": "求解",
        "action.results": "结果",
        "action.export_csv": "导出 CSV",
        "action.export_report": "导出报告(PDF/HTML)",
        "action.help": "帮助",
        "action.copyright": "版权",
        "action.undo": "撤销",
        "action.redo": "重做",
        "group.language": "语言",
        "language.zh": "中文",
        "language.en": "English",
        "objects": "对象",
        "xy_view": "XY 视图（可编辑）",
        "xz_view": "XZ 视图（仅显示）",
        "selection.none": "选择：无",
        "selection.prefix": "选择：",
        "selection.empty": "无",
        "point_props": "点属性",
        "member_length": "杆件长度",
        "assign_prop": "分配属性",
        "results": "结果",
        "results.title": "结果 - {rtype} ({combo})",
        "results.multiview": "多图结果 ({combo})",
        "layout": "布局",
        "export_all_images": "导出全部图片",
        "empty": "（空）",
        "click_inspect": "点击曲线点查看坐标",
        "export": "导出",
        "no_non_empty_plots": "没有可导出的非空图。",
        "exported_images": "已导出 {count} 张图片到\n{path}",
        "export_folder": "选择导出目录",
        "ctx.constraint": "约束…",
        "ctx.bush": "弹簧…",
        "ctx.load": "载荷…",
        "ctx.delete_point": "删除点",
        "ctx.udl": "分布载荷…",
        "ctx.add_point_here": "在此添加点",
        "ctx.delete_selected_points": "删除选中点",
        "dialog.spatial_mode.title": "选择建模模式",
        "dialog.spatial_mode.prompt": "请选择项目模式（创建后不可中途切换）：",
        "dialog.spatial_mode.2d": "2D（仅 XY 视图，平面梁）",
        "dialog.spatial_mode.3d": "3D（XY，XZ 双视图，空间梁）",
        "point.x": "X (mm)",
        "assign.table.id": "编号",
        "assign.table.len": "长度",
        "assign.table.mat": "材料",
        "assign.table.sec": "截面",
        "assign.table.clr": "清除",
        "tree.points": "点",
        "tree.members": "杆件",
        "tree.materials": "材料",
        "tree.sections": "截面",
        "tree.constraints": "约束",
        "tree.bush": "弹簧",
        "tree.loads": "载荷",
        "selection.points": "点：",
        "selection.members": "杆件：",
        "msg.library_load_failed": "库加载失败：已使用当前项目内置材料/截面。",
        "msg.help_pdf_fallback": "无法调用系统 PDF 查看器打开 help.pdf，已切换为内置帮助文本。",
        "msg.validate_ok": "OK：模型检查通过。",
        "msg.solve_ok": "求解成功。请到结果里查看。",
        "msg.no_results": "还没有结果。请先求解。",
        "msg.export_failed": "导出失败：{error}",
        "msg.export_ok": "已导出：\n{path}",
    },
    LANG_EN: {
        "tab.home": "Home",
        "tab.properties": "Properties",
        "tab.constraints_loads": "Constraints & Loads",
        "tab.background": "Background",
        "tab.solve_results": "Solve & Results",
        "tab.help": "Help",
        "group.file": "File",
        "group.model": "Model",
        "group.libraries": "Libraries",
        "group.assign": "Assign",
        "group.constraints": "Constraints",
        "group.loads": "Loads",
        "group.background": "Background",
        "group.solve": "Solve",
        "group.results": "Results",
        "group.support": "Support",
        "action.new": "New",
        "action.open": "Open",
        "action.save": "Save",
        "action.select": "Select",
        "action.add_point": "Add Point",
        "action.delete": "Delete",
        "action.materials": "Materials…",
        "action.sections": "Sections…",
        "action.assign_property": "Assign Property",
        "action.constraint": "Constraint",
        "action.bush": "Bush",
        "action.load": "Load",
        "action.udl": "UDL",
        "action.import": "Import",
        "action.calibrate": "Calibrate",
        "action.opacity": "Opacity",
        "action.bw": "B/W",
        "action.show_bg": "Show Background",
        "action.hide_bg": "Hide Background",
        "action.clear": "Clear",
        "action.validate": "Validate",
        "action.solve": "Solve",
        "action.results": "Results",
        "action.export_csv": "Export CSV",
        "action.export_report": "Export Report (PDF/HTML)",
        "action.help": "Help",
        "action.copyright": "Copyright",
        "action.undo": "Undo",
        "action.redo": "Redo",
        "group.language": "Language",
        "language.zh": "中文",
        "language.en": "English",
        "objects": "Objects",
        "xy_view": "XY View (editable)",
        "xz_view": "XZ View (display only)",
        "selection.none": "Selection: (none)",
        "selection.prefix": "Selection: ",
        "selection.empty": "(none)",
        "point_props": "Point Properties",
        "member_length": "Member length",
        "assign_prop": "Assign Property",
        "results": "Results",
        "results.title": "Results - {rtype} ({combo})",
        "results.multiview": "Results Multi-View ({combo})",
        "layout": "Layout",
        "export_all_images": "Export All Images",
        "empty": "(Empty)",
        "click_inspect": "Click curve point to inspect coordinates",
        "export": "Export",
        "no_non_empty_plots": "No non-empty plots to export.",
        "exported_images": "Exported {count} image(s) to\n{path}",
        "export_folder": "Select export folder",
        "ctx.constraint": "Constraint...",
        "ctx.bush": "Bush...",
        "ctx.load": "Load...",
        "ctx.delete_point": "Delete Point",
        "ctx.udl": "Distributed Load...",
        "ctx.add_point_here": "Add Point Here",
        "ctx.delete_selected_points": "Delete Selected Point(s)",
        "dialog.spatial_mode.title": "Choose Modeling Mode",
        "dialog.spatial_mode.prompt": "Choose project mode (cannot switch after creation):",
        "dialog.spatial_mode.2d": "2D (XY view only, planar beam)",
        "dialog.spatial_mode.3d": "3D (XY + XZ views, spatial beam)",
        "point.x": "X (mm)",
        "assign.table.id": "ID",
        "assign.table.len": "Len",
        "assign.table.mat": "Mat",
        "assign.table.sec": "Sec",
        "assign.table.clr": "Clr",
        "tree.points": "Points",
        "tree.members": "Members",
        "tree.materials": "Materials",
        "tree.sections": "Sections",
        "tree.constraints": "Constraints",
        "tree.bush": "Bush",
        "tree.loads": "Loads",
        "selection.points": "Points: ",
        "selection.members": "Members: ",
        "msg.library_load_failed": "Library load failed; using materials/sections embedded in the current project.",
        "msg.help_pdf_fallback": "Could not open help.pdf with the system PDF viewer; switched to built-in help text.",
        "msg.validate_ok": "OK: Model validation passed.",
        "msg.solve_ok": "Solve completed. Please check Results.",
        "msg.no_results": "No results yet. Please Solve first.",
        "msg.export_failed": "Export failed: {error}",
        "msg.export_ok": "Exported:\n{path}",
    },
}


def tr(lang: str, key: str, **kwargs) -> str:
    table = TRANSLATIONS.get(lang, TRANSLATIONS[LANG_EN])
    text = table.get(key, key)
    return text.format(**kwargs) if kwargs else text
